<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - E-Commerce</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/products" class="navbar-brand">üõí ShopMart</a>
            
            <ul class="navbar-menu">
                <li><a href="/products">Products</a></li>
                <li><a href="/cart">üõí Cart</a></li>
                <li><a href="/orders">My Orders</a></li>
                <li><a href="/profile" style="color: var(--primary-color);">Profile</a></li>
                <li>
                    <div class="navbar-user">
                        <div class="user-avatar" th:text="${#strings.substring(username, 0, 1).toUpperCase()}">U</div>
                        <span th:text="${username}">User</span>
                    </div>
                </li>
                <li>
                    <form th:action="@{/auth/logout}" method="post" style="margin: 0;">
                        <button type="submit" class="btn btn-sm btn-outline">Logout</button>
                    </form>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">My Profile</h1>
            <p class="page-subtitle">Manage your account and notifications</p>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: var(--spacing-lg);">
            <!-- Profile Info Card -->
            <div class="card">
                <div class="card-body" style="text-align: center;">
                    <div class="user-avatar" style="width: 100px; height: 100px; font-size: 2.5rem; margin: 0 auto var(--spacing-md);">
                        <span th:text="${#strings.substring(user.email, 0, 1).toUpperCase()}">U</span>
                    </div>
                    
                    <h2 class="card-title" th:text="${user.name}">User Name</h2>
                    <p class="card-text" th:text="${user.email}">user@example.com</p>
                    
                    <div style="margin-top: var(--spacing-md);">
                        <span 
                            class="order-status"
                            th:classappend="${user.role == 'ADMIN' ? 'status-completed' : 'status-created'}"
                            th:text="${user.role}"
                        >
                            Role
                        </span>
                    </div>
                </div>
            </div>

            <!-- Notifications Section -->
            <div class="card">
                <div class="card-body">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                        <h2 class="card-title" style="margin-bottom: 0;">Notifications</h2>
                        <form th:action="@{/profile/notifications/read-all}" method="post" style="margin: 0;">
                            <button type="submit" class="btn btn-sm btn-outline" th:disabled="${unreadCount == 0}">
                                Mark All as Read
                            </button>
                        </form>
                    </div>

                    <!-- Empty Notifications -->
                    <div th:if="${notifications == null or notifications.isEmpty()}" class="empty-state">
                        <div class="empty-state-icon" style="font-size: 3rem;">üîî</div>
                        <h3 class="empty-state-title" style="font-size: 1.25rem;">No notifications</h3>
                        <p class="empty-state-text">You're all caught up!</p>
                    </div>

                    <!-- Notifications List -->
                    <div class="notifications-container" th:if="${notifications != null and !notifications.isEmpty()}">
                        <div 
                            class="notification-item"
                            th:each="notification : ${notifications}"
                            th:classappend="${!notification.isRead ? 'notification-unread' : ''}"
                        >
                            <div class="notification-icon">
                                <span th:if="${notification.type == 'ORDER_PLACED'}">üõí</span>
                                <span th:if="${notification.type == 'ORDER_COMPLETED'}">‚úÖ</span>
                                <span th:if="${notification.type == 'SYSTEM'}">‚ÑπÔ∏è</span>
                            </div>
                            
                            <div class="notification-content">
                                <p class="notification-message" th:text="${notification.message}">Notification message</p>
                                <p class="notification-time" th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy hh:mm a')}">Time</p>
                            </div>
                            
                            <div th:if="${!notification.isRead}">
                                <form th:action="@{/profile/notifications/{id}/read(id=${notification.id})}" method="post" style="margin: 0;">
                                    <button type="submit" class="btn btn-sm btn-primary">Mark As Read</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-title">ShopMart</h3>
                    <p class="footer-text">Your one-stop shop for amazing products at great prices.</p>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="/products">Products</a></li>
                        <li><a href="/cart">Cart</a></li>
                        <li><a href="/orders">My Orders</a></li>
                        <li><a href="/profile">Profile</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">Customer Service</h4>
                    <ul class="footer-links">
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Shipping Info</a></li>
                        <li><a href="#">Returns</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-heading">Connect With Us</h4>
                    <div class="footer-social">
                        <a href="#" class="social-link">Facebook</a>
                        <a href="#" class="social-link">Twitter</a>
                        <a href="#" class="social-link">Instagram</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 ShopMart. All rights reserved.</p>
            </div>
        </div>
    </footer>

</body>
</html>